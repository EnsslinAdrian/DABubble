<div  *ngIf="mainContentService.navBarIsClosed$ | async" @toggleNavBar class="serverNav nav-Bar">
    <div class="serverNavContent nav-item" mode="side">
<div class="searchbar" [ngClass]="addClass">
  <div class="inputFrame" [ngClass]="{'align-reverse' : !align_reverse}">
    <input 
      [placeholder]="placeholder" 
      [(ngModel)]="searchQuery" 
      (input)="onSearchInput(searchQuery)" 
      (click)="onSearchInput(searchQuery)"
      (keydown.arrowUp)="navigateDropdown(-1)" 
      (keydown.arrowDown)="navigateDropdown(1)" 
      (keydown.enter)="onSearchInput(searchQuery); selectDropdownItem(); closeDevSpaceAndOpenChatForMobile();" 
      (focus)="showHints()" 
      (blur)="hideDropdown()"
    >
    <mat-icon (click)="onSearchInput(searchQuery); closeDevSpaceAndOpenChatForMobile()"
    >{{icon}}</mat-icon>
  </div>
  
  <div class="dropdown" *ngIf="showDropdown || displayHints">

    @if(this.displayHints){
      <div class="dropDownItem" *ngFor="let hint of allHints; let i = index" 
           [class.active]="i === activeDropdownIndex" 
           (click)="selectDropdownItem()"
           (mouseover)="setActiveDropdownIndex(i)">
        <span class="basicSearchSpan"><mat-icon>info</mat-icon>{{ hint }}</span>
      </div>
    } @else {
      <div *ngIf="members.length > 0">
        <div class="dropDownItem" *ngFor="let member of searchbarMember; let i = index" [class.active]="i === activeDropdownIndex" (click)="onDropdownItemClick(i)">
          <div class="searchBarContact">
            <div class="contactPictureContainer">
              <img class="contactPicture" [src]="member.imageUrl" alt="User picture" *ngIf="member.imageUrl">
              <img class="onlineStatus" [src]="member.status ? '/img/profile-pic/online.svg' : '/img/profile-pic/offline.svg'" alt="User picture" *ngIf="member.status !== undefined">
            </div>
            <span class="searchBarSpan">{{ member.name }}</span>
          </div>
        </div>
      </div>
    
      <div *ngIf="searchbarChannel.length > 0">
        <div class="dropDownItem" *ngFor="let channel of searchbarChannel; let i = index" [class.active]="i === activeDropdownIndex" (click)="onDropdownItemClick(i)">
          <span class="basicSearchSpan">{{ channel.title }}</span>
        </div>
      </div>
    
      <div *ngIf="messages.length > 0">
        <div class="dropDownItem" *ngFor="let message of messages; let i = index" [class.active]="i === activeDropdownIndex" (click)="onDropdownItemClick(i)">
          <span class="basicSearchSpan">{{ message.message }}</span>
        </div>
      </div>
    }

  </div>
</div>



        <div class="titleRow">
            <div class="titleAndServerSvg">
                <img src="/img/devspace/titleAndServerSvg.svg">
                <h2>Devspace</h2>
            </div>
            <button class="writeMessageButton" mat-icon-button (click)="openWriteAMessage()">
                <mat-icon>edit_square</mat-icon>
            </button>
        </div>

        <div class="dropwDownTopRow">
            <div class="dFlex" (click)="dropChannels()">
                <mat-icon class="dropDownArrow" [ngClass]="{'rotateArrow': channelsAreVisible}">arrow_drop_down</mat-icon>
                <mat-icon  class="channelsIcon">workspaces</mat-icon>
                <h3 class="folderTitle">Channels</h3>
            </div>
            <button class="addChannelPlus" (click)="openCreateChannelDialog()">
                <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14" fill="none">
                    <path
                        d="M7 14C6.71667 14 6.47933 13.904 6.288 13.712C6.096 13.5207 6 13.2833 6 13V8H1C0.716667 8 0.479 7.904 0.287 7.712C0.0956668 7.52067 0 7.28333 0 7C0 6.71667 0.0956668 6.479 0.287 6.287C0.479 6.09567 0.716667 6 1 6H6V1C6 0.716667 6.096 0.479 6.288 0.287C6.47933 0.0956668 6.71667 0 7 0C7.28333 0 7.521 0.0956668 7.713 0.287C7.90433 0.479 8 0.716667 8 1V6H13C13.2833 6 13.5207 6.09567 13.712 6.287C13.904 6.479 14 6.71667 14 7C14 7.28333 13.904 7.52067 13.712 7.712C13.5207 7.904 13.2833 8 13 8H8V13C8 13.2833 7.90433 13.5207 7.713 13.712C7.521 13.904 7.28333 14 7 14Z"
                        fill="black" />
                </svg>
            </button>
        </div>
        @if (channelsAreVisible) {
            <div class="dropDownChannelSection" @slideDown>
                <div
                  class="channel"
                  *ngFor="let channel of channels; let i = index"
                  (click)="messageService.checkWindowAndOpenChannel(channel)"
                >
                  <mat-icon>tag</mat-icon>
                  <span class="channel-text">{{ channel.title }}</span>
                </div>
            </div>              
        <div class="addChannelButton" (click)="openCreateChannelDialog()">
            <mat-icon class="material-icons">add_circle_outline</mat-icon>
            Add Channel
        </div>
        }
        <div class="dropwDownTopRow" (click)="dropContacts()">
            <div class="dFlex">
                <mat-icon class="dropDownArrow" [ngClass]="{'rotateArrow': contactsAreVisible}">arrow_drop_down</mat-icon>
                <mat-icon class="userIcon">account_circle</mat-icon>
                <h3 class="folderTitle">Direct messages</h3>
            </div>
        </div>
        @if (contactsAreVisible) {
        <div class="dropDownContacts" @slideDown class="dropdown-content">
            <div class="contact" *ngFor="let member of members; let i = index" (click)="openDirectMessage(member.id)">
                <div class="contactPicture">
                    <img class="userImage" src="{{member.imageUrl}}" alt="Member image">
                    <img class="onlineStatus" [src]="member.status ? '/img/profile-pic/online.svg' : '/img/profile-pic/offline.svg'" alt="Online status">
                </div>
                <span class="contactName">{{member.name}} @if(member.id === this.currentMember?.id) {(You)}</span>
            </div>
        </div>
        }
    </div>
</div>


<button type="button" class="toggleNavBarButton" (click)="mainContentService.toggleNavBar()">
    @if (mainContentService.navBarIsClosed$ | async) {
    <span>Workspace Menü öffnen</span>
    } @else {
    <span>Workspace Menü schließen</span>
    }
    <svg [ngStyle]="{'transform': (mainContentService.navBarIsClosed$ | async) ? 'rotate(90deg)' : 'rotate(-90deg)'}" xmlns="http://www.w3.org/2000/svg" width="18" height="19" viewBox="0 0 18 19" fill="none">
        <rect x="1" y="1.5" width="16" height="16" rx="1" stroke="black" stroke-width="2" />
        <path d="M6.71436 1.49997V17.5" stroke="black" stroke-width="2" />
        <path d="M10.143 11.7857L12.0752 9.85354C12.2704 9.65828 12.2704 9.3417 12.0752 9.14644L10.143 7.21428"
            stroke="black" stroke-width="2" stroke-linecap="round" />
    </svg>
</button>

<button *ngIf="mainContentService.navBarIsClosed$ | async" class="mobileWriteAMessageButton" (click)="openWriteAMessage()">
  <mat-icon class="editSquareIconAtMobileWriteAMessageButton">edit_square</mat-icon>
</button>